<html ng-app="myApp">
		<head>
			<title>First Angular</title>
			<script type="text/javascript" src="lib/angular.min.js"></script>
		</head>
		<body>
			<h2>{{'Angular'+'World'}}</h2>
			
				<h3>Http Call</h3>
				<script type="text/javascript">
				var myApp = angular.module('myApp', []);
				var response_object;

				function weather_params(datetext,rain_mm){
					this.datetext = datetext;
					this.rain_mm = rain_mm;
				}

				var weather_obj;
				var weather_date;
				var weather_date_copy = 0;
				var weather_op;
				var rainValue_copy = 0;

				myApp.controller('firstcontroller', function($scope,$http){
					$scope.names=['Alandur','Adambakkam','Adyar'];
					$scope.weather=[];

					$http.get("http://api.openweathermap.org/data/2.5/forecast?q=Chennai,in&appid=675e5e6e9c946570da621fea8c308d12").then(function(response){
							$scope.opdata = response.data;
							response_object = $scope.opdata.list;

							angular.forEach(response_object, function(value, key){
								var raininmm_obj = value.rain;
								weather_date = new Date(value.dt_txt.toString());
								var month = weather_date.getMonth()+1;
								weather_date = weather_date.getDate()+"-"+month+"-"+weather_date.getFullYear();
								var city_obj = value.city;
								//console.log(city_obj);
								if(raininmm_obj.hasOwnProperty('3h')){
									angular.forEach(raininmm_obj, function(rainvalue, rainkey){

										//weather_obj = new weather_params(weather_date,rainvalue); -- Original Data with complete 3 days report for Chennai
										if(weather_date_copy !=0){
											//console.log(weather_date_copy);
											if(weather_date_copy == weather_date){
												weather_op = weather_date;
												rainValue_copy = rainValue_copy + rainvalue;
												//console.log(rainValue_copy+" "+weather_op);
											}else {
												//weather_op  to be set in Weather_OBJ
												//console.log("OutPut after calculation, Total Rain Value: "+rainValue_copy+" , The day: "+weather_op);
												weather_obj = new weather_params(weather_op,rainValue_copy.toFixed(2));
												rainValue_copy = rainvalue;
												$scope.weather.push(weather_obj);
												//$scope.weather.push(weather_obj); - Should be done here;
											}
										}else{
										rainValue_copy = rainvalue;
										}
										
										weather_date_copy = weather_date;
										

									});
									
								}


							});
							
						});	
				});


				</script>
				<div class="HttpCall" ng-controller="firstcontroller">
					<ul>
						<li ng-repeat="x in weather">
							{{x.datetext + "-"+x.rain_mm}}
						</li>
					</ul>
			</div>
		</body>
</html>
